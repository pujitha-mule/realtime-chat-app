{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\M PUJITHA\\\\Downloads\\\\realtime-chat-app\\\\client\\\\src\\\\pages\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useCallback } from \"react\";\nimport { api } from \"../services/api\";\nimport ChatBox from \"../components/ChatBox\";\nimport RoomList from \"../components/RoomList\";\nimport socket from \"../services/socket\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat({\n  setToken\n}) {\n  _s();\n  const [rooms, setRooms] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [currentRoom, setCurrentRoom] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [user, setUser] = useState(null);\n  const [isUploading, setIsUploading] = useState(false);\n\n  // NEW STATE FOR FORM\n  const [isCreating, setIsCreating] = useState(false);\n  const [newRoomData, setNewRoomData] = useState({\n    name: \"\",\n    isPrivate: false,\n    showHistory: false\n  });\n  const navigate = useNavigate();\n  const handleLogout = useCallback(() => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    if (setToken) setToken(null);\n    socket.disconnect();\n    navigate(\"/login\");\n  }, [navigate, setToken]);\n\n  // 1. Initial Data & Socket Setup\n  useEffect(() => {\n    const storedUser = localStorage.getItem(\"user\");\n    const token = localStorage.getItem(\"token\");\n    if (!storedUser || !token) {\n      handleLogout();\n      return;\n    }\n    const parsedUser = JSON.parse(storedUser);\n    setUser(parsedUser);\n    const userId = parsedUser.id || parsedUser._id;\n    socket.connect();\n    const fetchData = async () => {\n      try {\n        const [roomsRes, usersRes] = await Promise.all([api.get(\"/rooms\"), api.get(\"/auth/users\")]);\n        const visibleRooms = roomsRes.data.filter(r => !r.isPrivate || r.members.some(m => (m._id || m) === userId));\n        setRooms(visibleRooms);\n        setUsers(usersRes.data);\n        if (visibleRooms.length > 0) setCurrentRoom(visibleRooms[0]);\n      } catch (err) {\n        var _err$response;\n        if (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 401) handleLogout();\n      }\n    };\n    fetchData();\n    socket.on(\"room_created\", newRoom => {\n      const isMember = newRoom.members.some(m => (m._id || m) === userId);\n      if (!newRoom.isPrivate || isMember) {\n        setRooms(prev => prev.find(r => r._id === newRoom._id) ? prev : [...prev, newRoom]);\n      }\n    });\n\n    // LISTENER FOR DELETION\n    socket.on(\"room_deleted\", roomId => {\n      setRooms(prev => prev.filter(r => r._id !== roomId));\n      if ((currentRoom === null || currentRoom === void 0 ? void 0 : currentRoom._id) === roomId) setCurrentRoom(null);\n    });\n    return () => {\n      socket.off(\"room_created\");\n      socket.off(\"room_deleted\");\n      socket.disconnect();\n    };\n  }, [handleLogout, currentRoom]);\n\n  // 2. Room Messaging Sync\n  useEffect(() => {\n    if (!currentRoom || !user) return;\n    const roomId = currentRoom._id;\n    socket.emit(\"join_room\", roomId);\n    api.get(`/messages/${roomId}`).then(res => setMessages(res.data)).catch(err => console.error(\"History error:\", err));\n    const handleReceive = msg => {\n      if (msg.roomId === roomId) setMessages(prev => [...prev, msg]);\n    };\n    socket.on(\"receive_message\", handleReceive);\n    return () => {\n      socket.off(\"receive_message\", handleReceive);\n      socket.emit(\"leave_room\", roomId);\n    };\n  }, [currentRoom, user]);\n\n  // --- ACTIONS ---\n\n  const handleCreateSubmit = async e => {\n    e.preventDefault();\n    try {\n      const res = await api.post(\"/rooms\", {\n        name: newRoomData.name.trim(),\n        isPrivate: newRoomData.isPrivate,\n        showHistoryToNewMembers: newRoomData.showHistory\n      });\n      const newRoom = res.data;\n      setRooms(prev => [...prev, newRoom]);\n      setCurrentRoom(newRoom);\n      setIsCreating(false);\n      setNewRoomData({\n        name: \"\",\n        isPrivate: false,\n        showHistory: false\n      });\n      socket.emit(\"create_room\", newRoom);\n    } catch (err) {\n      alert(\"Error creating room. The name might be taken.\");\n    }\n  };\n  const handleDeleteRoom = async roomId => {\n    if (!window.confirm(\"Are you sure? This cannot be undone.\")) return;\n    try {\n      await api.delete(`/rooms/${roomId}`);\n      setRooms(prev => prev.filter(r => r._id !== roomId));\n      setCurrentRoom(null);\n      socket.emit(\"delete_room\", roomId);\n    } catch (err) {\n      alert(\"You are not authorized to delete this room.\");\n    }\n  };\n  const handleJoinRoom = async room => {\n    try {\n      const res = await api.post(`/rooms/${room._id}/join`);\n      const updatedRoom = res.data;\n      setRooms(prev => prev.map(r => r._id === updatedRoom._id ? updatedRoom : r));\n      setCurrentRoom(updatedRoom);\n    } catch (err) {\n      alert(\"Failed to join.\");\n    }\n  };\n  const handleSelectUser = async targetUser => {\n    try {\n      const res = await api.post(\"/rooms/private\", {\n        targetUserId: targetUser._id\n      });\n      const privateRoom = res.data;\n      setRooms(prev => prev.find(r => r._id === privateRoom._id) ? prev : [...prev, privateRoom]);\n      setCurrentRoom(privateRoom);\n    } catch (err) {\n      console.error(\"Private chat error:\", err);\n    }\n  };\n  const sendTextMessage = text => {\n    if (!currentRoom || !text.trim() || !user) return;\n    socket.emit(\"send_message\", {\n      roomId: currentRoom._id,\n      content: text,\n      sender: user.id || user._id,\n      type: \"text\"\n    });\n  };\n  const sendFileMessage = async file => {\n    if (!currentRoom || !user) return;\n    setIsUploading(true);\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    formData.append(\"roomId\", currentRoom._id);\n    formData.append(\"senderId\", user.id || user._id);\n    try {\n      await api.post(\"/messages/upload\", formData, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      });\n    } catch (err) {\n      alert(\"Media upload failed.\");\n    } finally {\n      setIsUploading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid p-0 bg-light\",\n    style: {\n      height: \"100vh\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex h-100 shadow-sm overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(RoomList, {\n        rooms: rooms,\n        users: users,\n        currentUser: user,\n        currentRoomId: currentRoom === null || currentRoom === void 0 ? void 0 : currentRoom._id,\n        onSelectRoom: r => {\n          setCurrentRoom(r);\n          setIsCreating(false);\n        },\n        onSelectUser: u => {\n          handleSelectUser(u);\n          setIsCreating(false);\n        },\n        onJoinRoom: handleJoinRoom,\n        onCreateRoom: () => setIsCreating(true),\n        onLogout: handleLogout\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex flex-column flex-grow-1 bg-white position-relative\",\n        children: [isUploading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"position-absolute top-0 start-0 w-100 bg-primary text-white text-center py-1 z-3\",\n          children: \"Uploading media...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 13\n        }, this), isCreating ?\n        /*#__PURE__*/\n        /* --- NEW ROOM FORM --- */\n        _jsxDEV(\"div\", {\n          className: \"h-100 d-flex justify-content-center align-items-center bg-light\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card shadow p-4\",\n            style: {\n              width: \"400px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"mb-4\",\n              children: \"Create New Room\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleCreateSubmit,\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control mb-3\",\n                placeholder: \"Room Name\",\n                value: newRoomData.name,\n                onChange: e => setNewRoomData({\n                  ...newRoomData,\n                  name: e.target.value\n                }),\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-check form-switch mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-check-input\",\n                  type: \"checkbox\",\n                  checked: newRoomData.isPrivate,\n                  onChange: e => setNewRoomData({\n                    ...newRoomData,\n                    isPrivate: e.target.checked\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 226,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-check-label\",\n                  children: \"Private Room (Invited only)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 232,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-check form-switch mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-check-input\",\n                  type: \"checkbox\",\n                  checked: newRoomData.showHistory,\n                  onChange: e => setNewRoomData({\n                    ...newRoomData,\n                    showHistory: e.target.checked\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-check-label\",\n                  children: \"Allow late joiners to see history\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"submit\",\n                  className: \"btn btn-primary w-100\",\n                  children: \"Create Room\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"btn btn-outline-secondary w-100\",\n                  onClick: () => setIsCreating(false),\n                  children: \"Cancel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 13\n        }, this) : currentRoom ?\n        /*#__PURE__*/\n        /* --- CHAT INTERFACE --- */\n        _jsxDEV(\"div\", {\n          className: \"d-flex flex-column h-100\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 border-bottom bg-white shadow-sm d-flex justify-content-between align-items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n              className: \"mb-0 fw-bold\",\n              children: [currentRoom.isPrivate ? \"ðŸ”’ \" : \"# \", \" \", currentRoom.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex align-items-center gap-2\",\n              children: [currentRoom.isPrivate && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"badge bg-warning text-dark\",\n                children: \"Private\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 45\n              }, this), currentRoom.createdBy === ((user === null || user === void 0 ? void 0 : user.id) || (user === null || user === void 0 ? void 0 : user._id)) && /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-outline-danger btn-sm\",\n                onClick: () => handleDeleteRoom(currentRoom._id),\n                children: \"Delete Room\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-grow-1 overflow-hidden bg-light\",\n            children: currentRoom.isPrivate && !currentRoom.members.some(m => (m._id || m) === ((user === null || user === void 0 ? void 0 : user.id) || (user === null || user === void 0 ? void 0 : user._id))) ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-100 d-flex flex-column justify-content-center align-items-center text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"Private Room\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-muted\",\n                children: \"You must be invited to this room.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(ChatBox, {\n              messages: messages,\n              onSendText: sendTextMessage,\n              onSendFile: sendFileMessage,\n              currentUserId: (user === null || user === void 0 ? void 0 : user.id) || (user === null || user === void 0 ? void 0 : user._id)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-100 d-flex flex-column justify-content-center align-items-center text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-muted\",\n            children: \"Welcome\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Select a room or user to start chatting.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 191,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"Bt9rC2avbYLqskB2hdOUx/wSCb0=\", false, function () {\n  return [useNavigate];\n});\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["useEffect","useState","useCallback","api","ChatBox","RoomList","socket","useNavigate","jsxDEV","_jsxDEV","Chat","setToken","_s","rooms","setRooms","users","setUsers","currentRoom","setCurrentRoom","messages","setMessages","user","setUser","isUploading","setIsUploading","isCreating","setIsCreating","newRoomData","setNewRoomData","name","isPrivate","showHistory","navigate","handleLogout","localStorage","removeItem","disconnect","storedUser","getItem","token","parsedUser","JSON","parse","userId","id","_id","connect","fetchData","roomsRes","usersRes","Promise","all","get","visibleRooms","data","filter","r","members","some","m","length","err","_err$response","response","status","on","newRoom","isMember","prev","find","roomId","off","emit","then","res","catch","console","error","handleReceive","msg","handleCreateSubmit","e","preventDefault","post","trim","showHistoryToNewMembers","alert","handleDeleteRoom","window","confirm","delete","handleJoinRoom","room","updatedRoom","map","handleSelectUser","targetUser","targetUserId","privateRoom","sendTextMessage","text","content","sender","type","sendFileMessage","file","formData","FormData","append","headers","className","style","height","children","currentUser","currentRoomId","onSelectRoom","onSelectUser","u","onJoinRoom","onCreateRoom","onLogout","fileName","_jsxFileName","lineNumber","columnNumber","width","onSubmit","placeholder","value","onChange","target","required","checked","onClick","createdBy","onSendText","onSendFile","currentUserId","_c","$RefreshReg$"],"sources":["C:/Users/M PUJITHA/Downloads/realtime-chat-app/client/src/pages/Chat.js"],"sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\nimport { api } from \"../services/api\";\nimport ChatBox from \"../components/ChatBox\";\nimport RoomList from \"../components/RoomList\";\nimport socket from \"../services/socket\"; \nimport { useNavigate } from \"react-router-dom\";\n\nexport default function Chat({ setToken }) { \n  const [rooms, setRooms] = useState([]);\n  const [users, setUsers] = useState([]); \n  const [currentRoom, setCurrentRoom] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [user, setUser] = useState(null);\n  const [isUploading, setIsUploading] = useState(false);\n  \n  // NEW STATE FOR FORM\n  const [isCreating, setIsCreating] = useState(false);\n  const [newRoomData, setNewRoomData] = useState({\n    name: \"\",\n    isPrivate: false,\n    showHistory: false\n  });\n\n  const navigate = useNavigate();\n\n  const handleLogout = useCallback(() => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    if (setToken) setToken(null);\n    socket.disconnect();\n    navigate(\"/login\");\n  }, [navigate, setToken]);\n\n  // 1. Initial Data & Socket Setup\n  useEffect(() => {\n    const storedUser = localStorage.getItem(\"user\");\n    const token = localStorage.getItem(\"token\");\n\n    if (!storedUser || !token) {\n      handleLogout();\n      return;\n    }\n\n    const parsedUser = JSON.parse(storedUser);\n    setUser(parsedUser);\n    const userId = parsedUser.id || parsedUser._id;\n    socket.connect(); \n\n    const fetchData = async () => {\n      try {\n        const [roomsRes, usersRes] = await Promise.all([\n          api.get(\"/rooms\"),\n          api.get(\"/auth/users\")\n        ]);\n\n        const visibleRooms = roomsRes.data.filter(r => \n          !r.isPrivate || r.members.some(m => (m._id || m) === userId)\n        );\n\n        setRooms(visibleRooms);\n        setUsers(usersRes.data);\n        \n        if (visibleRooms.length > 0) setCurrentRoom(visibleRooms[0]);\n      } catch (err) {\n        if (err.response?.status === 401) handleLogout();\n      }\n    };\n\n    fetchData();\n\n    socket.on(\"room_created\", (newRoom) => {\n      const isMember = newRoom.members.some(m => (m._id || m) === userId);\n      if (!newRoom.isPrivate || isMember) {\n        setRooms((prev) => (prev.find(r => r._id === newRoom._id) ? prev : [...prev, newRoom]));\n      }\n    });\n\n    // LISTENER FOR DELETION\n    socket.on(\"room_deleted\", (roomId) => {\n      setRooms(prev => prev.filter(r => r._id !== roomId));\n      if (currentRoom?._id === roomId) setCurrentRoom(null);\n    });\n\n    return () => {\n      socket.off(\"room_created\");\n      socket.off(\"room_deleted\");\n      socket.disconnect();\n    };\n  }, [handleLogout, currentRoom]);\n\n  // 2. Room Messaging Sync\n  useEffect(() => {\n    if (!currentRoom || !user) return;\n    const roomId = currentRoom._id;\n    socket.emit(\"join_room\", roomId);\n\n    api.get(`/messages/${roomId}`)\n      .then((res) => setMessages(res.data))\n      .catch((err) => console.error(\"History error:\", err));\n\n    const handleReceive = (msg) => {\n      if (msg.roomId === roomId) setMessages((prev) => [...prev, msg]);\n    };\n\n    socket.on(\"receive_message\", handleReceive);\n    return () => {\n      socket.off(\"receive_message\", handleReceive);\n      socket.emit(\"leave_room\", roomId);\n    };\n  }, [currentRoom, user]);\n\n  // --- ACTIONS ---\n\n  const handleCreateSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      const res = await api.post(\"/rooms\", {\n        name: newRoomData.name.trim(),\n        isPrivate: newRoomData.isPrivate,\n        showHistoryToNewMembers: newRoomData.showHistory\n      });\n      \n      const newRoom = res.data;\n      setRooms(prev => [...prev, newRoom]);\n      setCurrentRoom(newRoom);\n      setIsCreating(false);\n      setNewRoomData({ name: \"\", isPrivate: false, showHistory: false });\n      \n      socket.emit(\"create_room\", newRoom); \n    } catch (err) {\n      alert(\"Error creating room. The name might be taken.\");\n    }\n  };\n\n  const handleDeleteRoom = async (roomId) => {\n    if (!window.confirm(\"Are you sure? This cannot be undone.\")) return;\n    try {\n      await api.delete(`/rooms/${roomId}`);\n      setRooms(prev => prev.filter(r => r._id !== roomId));\n      setCurrentRoom(null);\n      socket.emit(\"delete_room\", roomId); \n    } catch (err) {\n      alert(\"You are not authorized to delete this room.\");\n    }\n  };\n\n  const handleJoinRoom = async (room) => {\n    try {\n      const res = await api.post(`/rooms/${room._id}/join`);\n      const updatedRoom = res.data;\n      setRooms(prev => prev.map(r => r._id === updatedRoom._id ? updatedRoom : r));\n      setCurrentRoom(updatedRoom);\n    } catch (err) { alert(\"Failed to join.\"); }\n  };\n\n  const handleSelectUser = async (targetUser) => {\n    try {\n      const res = await api.post(\"/rooms/private\", { targetUserId: targetUser._id });\n      const privateRoom = res.data;\n      setRooms(prev => (prev.find(r => r._id === privateRoom._id) ? prev : [...prev, privateRoom]));\n      setCurrentRoom(privateRoom);\n    } catch (err) { console.error(\"Private chat error:\", err); }\n  };\n\n  const sendTextMessage = (text) => {\n    if (!currentRoom || !text.trim() || !user) return;\n    socket.emit(\"send_message\", {\n      roomId: currentRoom._id,\n      content: text,\n      sender: user.id || user._id, \n      type: \"text\",\n    });\n  };\n\n  const sendFileMessage = async (file) => {\n    if (!currentRoom || !user) return;\n    setIsUploading(true);\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    formData.append(\"roomId\", currentRoom._id);\n    formData.append(\"senderId\", user.id || user._id);\n    try {\n      await api.post(\"/messages/upload\", formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" },\n      });\n    } catch (err) { alert(\"Media upload failed.\"); } \n    finally { setIsUploading(false); }\n  };\n\n  return (\n    <div className=\"container-fluid p-0 bg-light\" style={{ height: \"100vh\" }}>\n      <div className=\"d-flex h-100 shadow-sm overflow-hidden\">\n        <RoomList\n          rooms={rooms}\n          users={users}\n          currentUser={user}\n          currentRoomId={currentRoom?._id}\n          onSelectRoom={(r) => { setCurrentRoom(r); setIsCreating(false); }}\n          onSelectUser={(u) => { handleSelectUser(u); setIsCreating(false); }}\n          onJoinRoom={handleJoinRoom}\n          onCreateRoom={() => setIsCreating(true)} \n          onLogout={handleLogout}\n        />\n\n        <div className=\"d-flex flex-column flex-grow-1 bg-white position-relative\">\n          {isUploading && (\n            <div className=\"position-absolute top-0 start-0 w-100 bg-primary text-white text-center py-1 z-3\">\n              Uploading media...\n            </div>\n          )}\n          \n          {isCreating ? (\n            /* --- NEW ROOM FORM --- */\n            <div className=\"h-100 d-flex justify-content-center align-items-center bg-light\">\n              <div className=\"card shadow p-4\" style={{ width: \"400px\" }}>\n                <h3 className=\"mb-4\">Create New Room</h3>\n                <form onSubmit={handleCreateSubmit}>\n                  <input \n                    className=\"form-control mb-3\" \n                    placeholder=\"Room Name\" \n                    value={newRoomData.name}\n                    onChange={e => setNewRoomData({...newRoomData, name: e.target.value})}\n                    required \n                  />\n                  <div className=\"form-check form-switch mb-2\">\n                    <input \n                      className=\"form-check-input\" \n                      type=\"checkbox\" \n                      checked={newRoomData.isPrivate}\n                      onChange={e => setNewRoomData({...newRoomData, isPrivate: e.target.checked})}\n                    />\n                    <label className=\"form-check-label\">Private Room (Invited only)</label>\n                  </div>\n                  <div className=\"form-check form-switch mb-4\">\n                    <input \n                      className=\"form-check-input\" \n                      type=\"checkbox\" \n                      checked={newRoomData.showHistory}\n                      onChange={e => setNewRoomData({...newRoomData, showHistory: e.target.checked})}\n                    />\n                    <label className=\"form-check-label\">Allow late joiners to see history</label>\n                  </div>\n                  <div className=\"d-flex gap-2\">\n                    <button type=\"submit\" className=\"btn btn-primary w-100\">Create Room</button>\n                    <button type=\"button\" className=\"btn btn-outline-secondary w-100\" onClick={() => setIsCreating(false)}>Cancel</button>\n                  </div>\n                </form>\n              </div>\n            </div>\n          ) : currentRoom ? (\n            /* --- CHAT INTERFACE --- */\n            <div className=\"d-flex flex-column h-100\">\n              <div className=\"p-3 border-bottom bg-white shadow-sm d-flex justify-content-between align-items-center\">\n                <h5 className=\"mb-0 fw-bold\">\n                  {currentRoom.isPrivate ? \"ðŸ”’ \" : \"# \"} {currentRoom.name}\n                </h5>\n                <div className=\"d-flex align-items-center gap-2\">\n                  {currentRoom.isPrivate && <span className=\"badge bg-warning text-dark\">Private</span>}\n                  \n                  {/* DELETE BUTTON: Checks if user is creator */}\n                  {(currentRoom.createdBy === (user?.id || user?._id)) && (\n                    <button className=\"btn btn-outline-danger btn-sm\" onClick={() => handleDeleteRoom(currentRoom._id)}>\n                      Delete Room\n                    </button>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"flex-grow-1 overflow-hidden bg-light\">\n                {currentRoom.isPrivate && !currentRoom.members.some(m => (m._id || m) === (user?.id || user?._id)) ? (\n                  <div className=\"h-100 d-flex flex-column justify-content-center align-items-center text-center\">\n                    <h3>Private Room</h3>\n                    <p className=\"text-muted\">You must be invited to this room.</p>\n                  </div>\n                ) : (\n                  <ChatBox \n                    messages={messages} \n                    onSendText={sendTextMessage} \n                    onSendFile={sendFileMessage}\n                    currentUserId={user?.id || user?._id}\n                  />\n                )}\n              </div>\n            </div>\n          ) : (\n            <div className=\"h-100 d-flex flex-column justify-content-center align-items-center text-center\">\n              <h4 className=\"text-muted\">Welcome</h4>\n              <p>Select a room or user to start chatting.</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}